<!doctype html>
<html>
<head>
<meta charset="utf-8">
<script type="text/javascript">

function xmlDom(){						// 创建兼容不同版本的XML DOM对象
    var a = [							// 构建不同版本字符串的数组
        "MSXML2.DOMDocument.5.0",
        "MSXML2.DOMDocument.4.0",
        "MSXML2.DOMDocument.3.0",
        "MSXML2.DOMDocument",
        "Microsoft.XmlDom"
    ];
    for(var i = 0 ; i < a.length; i++){	// 遍历数组
        try{							// 尝试从最新版本MSXML组件开始创建
            var o = new ActiveXObject(a[i]);
            return o; 				// 返回创建的对象实例
        }
        catch(e)
        {}
    }
    throw new Error("浏览器不支持MSXML组件");
	// 如果所有版本MSXML组件都不支持，则抛出异常
}



var o = xmlDom();					// 创建XML DOM对象
o.onreadystatechange = function() {
	if(o.readyState == 4)
		document.write(o.xml); 			// 输出XML数据为字符串
}
o.load("test.xml");					// 加载XML文件


</script>
<title></title>
</head>

<body>
</body>
</html>
